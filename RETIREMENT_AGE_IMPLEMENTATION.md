# ××¢×¨×›×ª ×’×™×œ ×¤×¨×™×©×” ×“×™× ××™×ª - ×ª×™×¢×•×“ ××œ×

## ×¡×§×™×¨×” ×›×œ×œ×™×ª

×”××¢×¨×›×ª ×¢×‘×¨×” ×©×“×¨×•×’ ××§×™×£ ×œ×”×¤×™×›×ª ×’×™×œ ×”×¤×¨×™×©×” ×œ×“×™× ××™ ×•××‘×•×¡×¡ ×¢×œ ×—×•×§ ×™×©×¨××œ×™. ×‘××§×•× ×”×’×“×¨×•×ª ×§×‘×•×¢×•×ª (67 ×œ×’×‘×¨×™×, 62 ×œ× ×©×™×), ×”××¢×¨×›×ª ×›×¢×ª ××—×©×‘×ª ××ª ×’×™×œ ×”×¤×¨×™×©×” ×”××“×•×™×§ ×œ×¤×™ ×ª××¨×™×š ×œ×™×“×” ×•××’×“×¨.

## ×©×™× ×•×™×™× ××¨×›×–×™×™×

### 1. Backend - ×©×™×¨×•×ª ×—×™×©×•×‘ ×’×™×œ ×¤×¨×™×©×”

#### ×§×•×‘×¥ ×—×“×©: `app/services/retirement_age_service.py`

**×ª×›×•× ×•×ª:**
- ×˜×‘×œ×” ××œ××” ×©×œ ×’×™×œ××™ ×¤×¨×™×©×” ×œ× ×©×™× ×œ×¤×™ ×—×•×§ ×™×©×¨××œ×™ (1944-1970+)
- ×—×™×©×•×‘ ××“×•×™×§ ×›×•×œ×œ ×—×•×“×©×™× (×œ× ×¨×§ ×©× ×™× ×©×œ××•×ª)
- ×ª××™×›×” ×‘×”×’×“×¨×•×ª ××•×ª×××•×ª ××™×©×™×ª
- ×©××™×¨×ª ×”×’×“×¨×•×ª ×‘-JSON

**×¤×•× ×§×¦×™×•×ª ×¢×™×§×¨×™×•×ª:**
- `calculate_retirement_age(birth_date, gender)` - ×—×™×©×•×‘ ××œ× ×¢× ×©× ×™× ×•×—×•×“×©×™×
- `get_retirement_age_simple(birth_date, gender)` - ×—×™×©×•×‘ ×‘×©× ×™× ×©×œ××•×ª (×ª××™××•×ª ×œ××—×•×¨)
- `get_retirement_date(birth_date, gender)` - ××—×–×™×¨ ×ª××¨×™×š ×¤×¨×™×©×” ××“×•×™×§
- `load_retirement_age_settings()` - ×˜×¢×™× ×ª ×”×’×“×¨×•×ª ××§×•×‘×¥
- `save_retirement_age_settings()` - ×©××™×¨×ª ×”×’×“×¨×•×ª ×œ×§×•×‘×¥

**×˜×‘×œ×ª ×’×™×œ××™ ×¤×¨×™×©×” ×œ× ×©×™×:**
```
×ª××¨×™×š ×œ×™×“×”              ×’×™×œ ×¤×¨×™×©×”
×¢×“ ××¨×¥ 1944             60
××¤×¨×™×œ-××•×’×•×¡×˜ 1944       60 + 4 ×—×•×“×©×™×
×¡×¤×˜××‘×¨ 1944-××¤×¨×™×œ 1945  60 + 8 ×—×•×“×©×™×
×××™-×“×¦××‘×¨ 1945          61
×™× ×•××¨-××•×’×•×¡×˜ 1946       61 + 4 ×—×•×“×©×™×
×¡×¤×˜××‘×¨ 1946-××¤×¨×™×œ 1947  61 + 8 ×—×•×“×©×™×
×××™ 1947-×“×¦××‘×¨ 1959     62
×™× ×•××¨-×“×¦××‘×¨ 1960        62 + 4 ×—×•×“×©×™×
×™× ×•××¨-×“×¦××‘×¨ 1961        62 + 8 ×—×•×“×©×™×
×™× ×•××¨-×“×¦××‘×¨ 1962        63
×™× ×•××¨-×“×¦××‘×¨ 1963        63 + 3 ×—×•×“×©×™×
×™× ×•××¨-×“×¦××‘×¨ 1964        63 + 6 ×—×•×“×©×™×
×™× ×•××¨-×“×¦××‘×¨ 1965        63 + 9 ×—×•×“×©×™×
×™× ×•××¨-×“×¦××‘×¨ 1966        64
×™× ×•××¨-×“×¦××‘×¨ 1967        64 + 3 ×—×•×“×©×™×
×™× ×•××¨-×“×¦××‘×¨ 1968        64 + 6 ×—×•×“×©×™×
×™× ×•××¨-×“×¦××‘×¨ 1969        64 + 9 ×—×•×“×©×™×
1970 ×•××™×œ×š              65
```

#### ×§×•×‘×¥ ×—×“×©: `app/routers/retirement_age.py`

**API Endpoints:**
- `POST /api/v1/retirement-age/calculate` - ×—×™×©×•×‘ ×’×™×œ ×¤×¨×™×©×” ××œ×
- `POST /api/v1/retirement-age/calculate-simple` - ×—×™×©×•×‘ ×¤×©×•×˜ (×©× ×™× ×©×œ××•×ª)
- `GET /api/v1/retirement-age/settings` - ×§×‘×œ×ª ×”×’×“×¨×•×ª × ×•×›×—×™×•×ª
- `POST /api/v1/retirement-age/settings` - ×¢×“×›×•×Ÿ ×”×’×“×¨×•×ª

### 2. ×¢×“×›×•×Ÿ ×©×™×¨×•×ª×™ Backend ×§×™×™××™×

#### `services/eligibility.py`
- **×œ×¤× ×™:** ×’×™×œ ×¤×¨×™×©×” ×§×‘×•×¢ (67/62)
- **××—×¨×™:** ×©×™××•×© ×‘-`retirement_age_service.get_retirement_date()`

#### `app/services/rights_fixation.py`
- **×œ×¤× ×™:** `birth_date.year + (67 if gender == "male" else 62)`
- **××—×¨×™:** `get_retirement_date(birth_date, gender)`

#### `app/services/indexation_service.py`
- **×œ×¤× ×™:** `retirement_age = 67 if gender.lower() in ['m', 'male', '×–×›×¨'] else 62`
- **××—×¨×™:** `get_retirement_date(birth_date, gender)`

#### `app/services/case_service.py`
- **×œ×¤× ×™:** `retirement_age: int = 67` (×¤×¨××˜×¨ ×§×‘×•×¢)
- **××—×¨×™:** `retirement_age: Optional[int] = None` + ×—×™×©×•×‘ ×“×™× ××™ ××ª××¨×™×š ×œ×™×“×”

#### `app/main.py`
- ×”×•×¡×¤×ª `retirement_age` router ×œ××¤×œ×™×§×¦×™×”

### 3. Frontend - ×××©×§ ××©×ª××©

#### ×§×•×‘×¥ ×—×“×©: `frontend/src/utils/retirementAge.ts`

**×¤×•× ×§×¦×™×•×ª ×¢×–×¨:**
- `calculateRetirementAge(birthDate, gender)` - ×—×™×©×•×‘ ××œ×
- `calculateRetirementAgeSimple(birthDate, gender)` - ×—×™×©×•×‘ ×¤×©×•×˜
- `getRetirementAgeSettings()` - ×§×‘×œ×ª ×”×’×“×¨×•×ª ××¢×¨×›×ª
- `getDefaultRetirementAge(gender)` - ×‘×¨×™×¨×ª ××—×“×œ ×œ×¤×™ ××’×“×¨

#### `frontend/src/pages/SystemSettings.tsx`

**×œ×©×•× ×™×ª ×—×“×©×”: "ğŸ‘¤ ×’×™×œ ×¤×¨×™×©×”"**

×ª×›×•× ×•×ª:
- ×”×’×“×¨×ª ×’×™×œ ×¤×¨×™×©×” ×œ×’×‘×¨×™× (×‘×¨×™×¨×ª ××—×“×œ: 67)
- ×‘×—×™×¨×” ×‘×™×Ÿ ×˜×‘×œ×” ×—×•×§×™×ª ×œ×’×™×œ ×§×‘×•×¢ ×œ× ×©×™×
- ×”×¦×’×ª ×˜×‘×œ×” ××œ××” ×©×œ ×’×™×œ××™ ×¤×¨×™×©×” ×œ× ×©×™×
- ×©××™×¨×” ×•×˜×¢×™× ×” ×©×œ ×”×’×“×¨×•×ª
- ×”×•×“×¢×•×ª ××©×•×‘ ×œ××©×ª××©

### 4. ×§×•×‘×¥ ×”×’×“×¨×•×ª

**×§×•×‘×¥ ×—×“×©:** `retirement_age_settings.json` (× ×•×¦×¨ ××•×˜×•××˜×™×ª)

```json
{
  "male_retirement_age": 67,
  "use_legal_table_for_women": true,
  "female_retirement_age": 65
}
```

## ×“×•×’×××•×ª ×©×™××•×©

### Backend (Python)

```python
from app.services.retirement_age_service import (
    calculate_retirement_age,
    get_retirement_age_simple,
    get_retirement_date
)
from datetime import date

# ×“×•×’××” 1: ××™×©×” ×©× ×•×œ×“×” ×‘-1965
birth_date = date(1965, 6, 15)
result = calculate_retirement_age(birth_date, "female")
print(f"×’×™×œ ×¤×¨×™×©×”: {result['age_years']} ×©× ×™× ×•-{result['age_months']} ×—×•×“×©×™×")
# ×¤×œ×˜: ×’×™×œ ×¤×¨×™×©×”: 63 ×©× ×™× ×•-9 ×—×•×“×©×™×

# ×“×•×’××” 2: ×’×‘×¨ ×©× ×•×œ×“ ×‘-1960
birth_date = date(1960, 3, 20)
age = get_retirement_age_simple(birth_date, "male")
print(f"×’×™×œ ×¤×¨×™×©×”: {age}")
# ×¤×œ×˜: ×’×™×œ ×¤×¨×™×©×”: 67

# ×“×•×’××” 3: ×§×‘×œ×ª ×ª××¨×™×š ×¤×¨×™×©×” ××“×•×™×§
retirement_date = get_retirement_date(birth_date, "male")
print(f"×ª××¨×™×š ×¤×¨×™×©×”: {retirement_date}")
# ×¤×œ×˜: ×ª××¨×™×š ×¤×¨×™×©×”: 2027-03-20
```

### Frontend (TypeScript)

```typescript
import { 
  calculateRetirementAgeSimple,
  getDefaultRetirementAge 
} from '../utils/retirementAge';

// ×“×•×’××” 1: ×—×™×©×•×‘ ×’×™×œ ×¤×¨×™×©×” ×œ×œ×§×•×—
const age = await calculateRetirementAgeSimple('1965-06-15', 'female');
console.log(`×’×™×œ ×¤×¨×™×©×”: ${age}`);
// ×¤×œ×˜: ×’×™×œ ×¤×¨×™×©×”: 64

// ×“×•×’××” 2: ×§×‘×œ×ª ×‘×¨×™×¨×ª ××—×“×œ ×œ×¤×™ ××’×“×¨
const defaultAge = await getDefaultRetirementAge('male');
console.log(`×’×™×œ ×‘×¨×™×¨×ª ××—×“×œ: ${defaultAge}`);
// ×¤×œ×˜: ×’×™×œ ×‘×¨×™×¨×ª ××—×“×œ: 67
```

### API Calls

```bash
# ×—×™×©×•×‘ ×’×™×œ ×¤×¨×™×©×”
curl -X POST http://localhost:8005/api/v1/retirement-age/calculate \
  -H "Content-Type: application/json" \
  -d '{"birth_date": "1965-06-15", "gender": "female"}'

# ×ª×©×•×‘×”:
{
  "age_years": 63,
  "age_months": 9,
  "retirement_date": "2029-03-15",
  "source": "legal_table"
}

# ×§×‘×œ×ª ×”×’×“×¨×•×ª
curl http://localhost:8005/api/v1/retirement-age/settings

# ×¢×“×›×•×Ÿ ×”×’×“×¨×•×ª
curl -X POST http://localhost:8005/api/v1/retirement-age/settings \
  -H "Content-Type: application/json" \
  -d '{
    "male_retirement_age": 67,
    "use_legal_table_for_women": true
  }'
```

## ×”×©×¤×¢×•×ª ×¢×œ ×”××¢×¨×›×ª

### ××•×“×•×œ×™× ×©×¢×•×“×›× ×•:
1. âœ… **×§×™×‘×•×¢ ×–×›×•×™×•×ª** - ×—×™×©×•×‘ ×ª××¨×™×š ×–×›××•×ª ××“×•×™×§
2. âœ… **×–×™×”×•×™ ××§×¨×™× (Case Detection)** - ×–×™×”×•×™ ××•×˜×•××˜×™ ×©×œ ×’×™×œ ×¤×¨×™×©×”
3. âœ… **×ª×¨×—×™×©×™ ×¤×¨×™×©×”** - ×ª××™×›×” ×‘×’×™×œ ×¤×¨×™×©×” ×“×™× ××™
4. âœ… **×—×™×©×•×‘×™ ××¡ ×•×”×¦××“×”** - ×©×™××•×© ×‘×ª××¨×™×š ×¤×¨×™×©×” ××“×•×™×§
5. âœ… **×“×•×—×•×ª ×•×ª×–×¨×™×** - ×”×ª×××” ×œ×’×™×œ ×¤×¨×™×©×” ×××™×ª×™

### ××•×“×•×œ×™× ×©×œ× ×”×©×ª× ×• (×¢×“×™×™×Ÿ ××©×ª××©×™× ×‘×‘×—×™×¨×” ×™×“× ×™×ª):
- **Scenarios.tsx** - ×”××©×ª××© ×‘×•×—×¨ ×’×™×œ ×¤×¨×™×©×”
- **RetirementScenarios.tsx** - ×”××©×ª××© ×‘×•×—×¨ ×’×™×œ ×¤×¨×™×©×”
- **SimpleReports.tsx** - ××©×ª××© ×‘× ×ª×•× ×™× ××”×©×¨×ª

## ×ª××™××•×ª ×œ××—×•×¨

×”××¢×¨×›×ª ×©×•××¨×ª ×¢×œ ×ª××™××•×ª ××œ××” ×œ××—×•×¨:
- ×¤×•× ×§×¦×™×•×ª ×™×©× ×•×ª ×××©×™×›×•×ª ×œ×¢×‘×•×“
- ×§×‘×•×¢×™× `ELIG_AGE_MALE` ×•-`ELIG_AGE_FEMALE` ×¢×“×™×™×Ÿ ×§×™×™××™×
- ×¤×¨××˜×¨ `retirement_age` ××•×¤×¦×™×•× ×œ×™ ×‘×¤×•× ×§×¦×™×•×ª

## ×‘×“×™×§×•×ª ××•××œ×¦×•×ª

### ×ª×¨×—×™×©×™ ×‘×“×™×§×”:

1. **××™×©×” ×©× ×•×œ×“×” ×‘-1960** â†’ ×’×™×œ ×¤×¨×™×©×”: 62 + 4 ×—×•×“×©×™×
2. **××™×©×” ×©× ×•×œ×“×” ×‘-1965** â†’ ×’×™×œ ×¤×¨×™×©×”: 63 + 9 ×—×•×“×©×™×
3. **××™×©×” ×©× ×•×œ×“×” ×‘-1970** â†’ ×’×™×œ ×¤×¨×™×©×”: 65
4. **×’×‘×¨ ×©× ×•×œ×“ ×‘-1960** â†’ ×’×™×œ ×¤×¨×™×©×”: 67
5. **×œ×§×•×— ×œ×œ× ×ª××¨×™×š ×œ×™×“×”** â†’ ×©×™××•×© ×‘×‘×¨×™×¨×ª ××—×“×œ

### ×‘×“×™×§×•×ª ×¤×•× ×§×¦×™×•× ×œ×™×•×ª:

```bash
# ×”×¨×¦×ª ×”×˜×¡×˜×™×
pytest tests/test_retirement_age.py -v

# ×‘×“×™×§×ª API
python -m pytest tests/test_retirement_age_api.py -v
```

## ×”×’×“×¨×•×ª ××•××œ×¦×•×ª

```json
{
  "male_retirement_age": 67,
  "use_legal_table_for_women": true
}
```

**×”×¡×‘×¨:**
- `male_retirement_age: 67` - ×’×™×œ ×¤×¨×™×©×” ×œ×’×‘×¨×™× ×œ×¤×™ ×—×•×§
- `use_legal_table_for_women: true` - ×©×™××•×© ×‘×˜×‘×œ×” ×”×—×•×§×™×ª (××•××œ×¥!)

## ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª

### ×‘×¢×™×”: "Cannot find module retirement_age_service"
**×¤×ª×¨×•×Ÿ:** ×•×“× ×©-`app/services/retirement_age_service.py` ×§×™×™×

### ×‘×¢×™×”: ×”×’×“×¨×•×ª ×œ× × ×©××¨×•×ª
**×¤×ª×¨×•×Ÿ:** ×•×“× ×”×¨×©××•×ª ×›×ª×™×‘×” ×œ×ª×™×§×™×™×ª ×”××¢×¨×›×ª

### ×‘×¢×™×”: ×’×™×œ ×¤×¨×™×©×” ×œ× ××“×•×™×§ ×œ× ×©×™×
**×¤×ª×¨×•×Ÿ:** ×•×“× ×©-`use_legal_table_for_women: true` ×‘×”×’×“×¨×•×ª

## ×ª×—×–×•×§×” ×¢×ª×™×“×™×ª

### ×”×•×¡×¤×ª ×©× ×™× ×—×“×©×•×ª ×œ×˜×‘×œ×”:
×¢×¨×•×š ××ª `FEMALE_RETIREMENT_AGE_TABLE` ×‘-`retirement_age_service.py`

### ×©×™× ×•×™ ×’×™×œ ×¤×¨×™×©×” ×œ×’×‘×¨×™×:
×¢×“×›×Ÿ ×“×¨×š ×××©×§ ×”××©×ª××© ××• ×™×©×™×¨×•×ª ×‘×§×•×‘×¥ `retirement_age_settings.json`

## ×¡×™×›×•×

×”××¢×¨×›×ª ×›×¢×ª ×ª×•××›×ª ×‘×—×™×©×•×‘ ×’×™×œ ×¤×¨×™×©×” ×“×™× ××™ ×•××“×•×™×§ ×œ×¤×™ ×—×•×§ ×™×©×¨××œ×™, ×¢× ××¤×©×¨×•×ª ×œ×”×ª×××” ××™×©×™×ª ×“×¨×š ×××©×§ ××©×ª××© ×™×“×™×“×•×ª×™. ×›×œ ×”×©×™×¨×•×ª×™× ×”××¨×›×–×™×™× ×¢×•×“×›× ×• ×œ×”×©×ª××© ×‘××¢×¨×›×ª ×”×—×“×©×” ×ª×•×š ×©××™×¨×” ×¢×œ ×ª××™××•×ª ×œ××—×•×¨.

---
**×ª××¨×™×š ×™×¦×™×¨×”:** 21/10/2025  
**×’×¨×¡×”:** 1.0  
**××—×‘×¨:** ××¢×¨×›×ª AI
